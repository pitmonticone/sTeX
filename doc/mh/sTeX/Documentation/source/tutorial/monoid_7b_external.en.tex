\documentclass{stex}
\libinput{docpreamble}
\begin{document}

\begin{smodule}{Monoid}
  \begin{mathstructure}{monoid}
    \symdef{universe}[op=\comp{M}_{\this}]{\comp{M}_{\this}}
    \symdef{op}[args=a,op=\comp{\circ}_{\this}]{#1}
      {##1 \mathbin{\comp{\circ}_{\this}} ##2}
    \symdef{unit}[op=\comp{e}_{\this}]{\comp{e}_{\this}}
  \end{mathstructure}

  \usemodule[sTeX/MathBase/Functions]{mod?Function}
  \usemodule[sTeX/MathBase/Relations]{mod?Equal}

  \begin{definition}
    \vardef{vx}[name=x]{\comp{x}}
    A \textbf{\symname{monoid}} is a \symref{mathstruct}{structure} 
    $\monoid{}{}$ with 
    $\fun{\monoid{}{op}!}{\monoid{}{universe},\monoid{}{universe}}
      {\monoid{}{universe}}$, such that $\monoid{}{op}!$ 
    is associative and $\eq{\monoid{}{op}{\vx,\monoid{}{unit}},
      \monoid{}{op}{\monoid{}{unit},\vx},\vx}$ 
    for all $\inset{\vx}{\monoid{}{universe}}$.
  \end{definition}
\end{smodule}

\end{document}
