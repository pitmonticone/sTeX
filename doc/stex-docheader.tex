\RequirePackage{paralist}
\ifcsname stexdocpath\endcsname\else\def\stexdocpath{.}\fi
\documentclass[full]{l3doc}
%\RequirePackage{document-structure}
\usepackage[hyperref=auto,style=alphabetic]{biblatex}
%\usepackage[mathhub=\stexdocpath/mh,usesms]{stex}
\usepackage{stex}
\usepackage{stex-highlighting,stexthm}

\newif\ifhadtitle\hadtitlefalse

\def\fileversion{3.3.0}
\def\filedate{\today}
\def\stexdoctitle#1#2{\title{#1\thanks{Version {\fileversion} (last revised {\filedate})} }\def\thispkg{#2}}

\author{Michael Kohlhase, Dennis Müller\\
 	FAU Erlangen-Nürnberg\\
 	\url{http://kwarc.info/}
}

\def\stexmaketitle{\ifhadtitle\else\hadtitletrue\maketitle\fi}

\def\docmodule{
\begin{document}
  \EnableManual
  \DisableImplementation
  \DocInput{\jobname.dtx}
  \EnableImplementation
  \DisableDocumentation
  \DisableManual
  \DocInputAgain
  \clearpage
  \PrintIndex
\end{document}
}

\ExplSyntaxOn
  \bool_new:N \g_stexdoc_typeset_manual_bool
  \NewDocumentCommand \EnableManual {}{
    \bool_gset_true:N \g_stexdoc_typeset_manual_bool
  }
  \NewDocumentCommand \DisableManual {}{
    \bool_gset_false:N \g_stexdoc_typeset_manual_bool
  }
  \NewDocumentEnvironment {stexmanual} {} {
    \bool_if:NTF \g_stexdoc_typeset_manual_bool
      {\bool_set_false:N \l__codedoc_in_implementation_bool}
      {\comment}
  }{
    \bool_if:NF \g_stexdoc_typeset_manual_bool {\endcomment}
  }
\ExplSyntaxOff

%\usepackage{makeidx}
%\makeindex

%\usepackage{document-structure}
\ExplSyntaxOn

\cs_set_nopar:Nn \_stexdoc_do_cs:Nn {
  \stex_debug:nn{here}{\tl_to_str:n{#1},~#2}
  \cs_if_exist:cTF{s\tl_to_str:n{#2}}{
    \cs_if_exist:cTF{s\tl_to_str:n{#2}name}{
    \symref{#2-sym}{#1{#2}}
    }{#1{#2}}
  }{
    #1{#2}
  }
}
\let\my_old_cs\cs
\protected\def\cs#1{
  \_stexdoc_do_cs:Nn \my_old_cs{#1}
}
\let\my_old_cmd\cmd
\protected\def\cmd#1{
  \_stexdoc_do_cs:Nn \my_old_cmd{#1}
}

\ExplSyntaxOff

\mhinput[sTeX/Documentation]{../lib/examples.tex}