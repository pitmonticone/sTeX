\ProvidesExplPackage{stex-compatibility}{2021/08/01}{1.9}{bla}
%\RequirePackage[lang={de,en,ro,tr,fr}]{stex}
\RequirePackage[lang=en]{stex}

\NewDocumentEnvironment { mhmodnl } { O{} m m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    Environment~mhmodnl~is~deprected! \\
    Please~update~module~#2~in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq!
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}

  \begin{module}[#1,lang=#3]{#2}
    \seq_set_eq:NN \l_tmpa_seq \g_stex_currentfile_seq
    \seq_pop_right:NN \l_tmpa_seq \l_tmpa_str
    \seq_set_split:NnV \l_tmpb_seq . \l_tmpa_str
    \seq_pop_left:NN \l_tmpb_seq \l_tmpa_str
    \input { \stex_path_to_string:N \l_tmpa_seq / \l_tmpa_str.tex }
} {
  \end{module}
}

\NewDocumentEnvironment { modsig } { O{} m } {
  \stex_if_in_module:TF {
    \prop_get:NnN \l_stex_current_module_prop {name} \l_tmpa_str
    \str_set:Nn \l_tmpb_str { #2 }
    \str_if_eq:NNTF \l_tmpa_str \l_tmpb_str {
      \prop_set_eq:NN \l_modsig_old_module_prop \l_stex_current_module_prop
      \begin{@module}{modsig-#2}
       % \prop_set_eq:NN \l_stex_current_module_prop \l_modsig_old_module_prop 
    } {
      \begin{@module}{#2}
    }
  } {
    \begin{@module}{#2}
  }
}{
  \end{@module}
  \AddToHookNext { env / modsig / after }{
    \stex_if_in_module:T {
      \prop_get:NnN \l_stex_current_module_prop {name} \l_tmpa_str
      \str_set:Nn \l_tmpb_str { #2 }
      \str_if_eq:NNT \l_tmpa_str \l_tmpb_str {
  %      \xdef \g_stex_module_after_group_tl {
          \stex_if_smsmode:TF {          
            \exp_args:Nx
            \stex_add_to_current_module:n {
              \stex_debug:n{Activating~signature~of~#2}
              \exp_not:N \prop_item:cn { c_stex_module_ 
              \prop_item:Nn \l_stex_current_module_prop {ns} ?
              \prop_item:Nn \l_stex_current_module_prop {name}
              / modsig-#2_prop } { content }
            }
          } 
          {
            \gdef \g_stex_modsig_after_group_tl  {
              \stex_activate_module:n {
                \prop_item:Nn \l_stex_current_module_prop {ns} ?
                \prop_item:Nn \l_stex_current_module_prop {name}
                / modsig-#2
              }
              
              \exp_args:Nx
              \stex_add_to_current_module:n {
                \stex_activate_module:n {
                  \prop_item:Nn \l_stex_current_module_prop {ns} ?
                  \prop_item:Nn \l_stex_current_module_prop {name}
                  / modsig-#2
                }
              }
            }
            \aftergroup \g_stex_modsig_after_group_tl
          }
      }
    }
  }
}

\cs_new_protected:Npn \gimport {
  \peek_charcode_remove:NTF * {
    \gimport_do:
  } {
    \gimport_do:
  }
}

\NewDocumentCommand \gimport_do: { O{} m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    \c_backslash_str gimport~is~deprecated! \\
    Please~use~\c_backslash_str importmodule[#1]{#2}~instead!~(in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq)
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}
  \importmodule[#1]{#2}
}

\cs_new_protected:Npn \guse {
  \peek_charcode_remove:NTF * {
    \guse_do:
  } {
    \guse_do:
  }
}

\NewDocumentCommand \guse_do: { O{} m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    \c_backslash_str guse~is~deprecated! \\
    Please~use~\c_backslash_str usemodule[#1]{#2}~instead!~(in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq)
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}
  \usemodule[#1]{#2}
}

\cs_new:Nn \stex_capitalize:n { \uppercase{#1} }

\cs_new_protected:Npn \symi {
  \peek_charcode_remove:NTF * {
    \symi_do:
  } {
    \symi_do:
  }
}

\NewDocumentCommand \symi_do: { O{} m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    \c_backslash_str symi~is~deprecated! \\
    Please~use~\c_backslash_str symdecl[#1]{#2}~instead!~(in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq)
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}
  \symdecl*[#1]{#2}
}

\cs_new_protected:Npn \symii {
  \peek_charcode_remove:NTF * {
    \symii_do:
  } {
    \symii_do:
  }
}

\NewDocumentCommand \symii_do: { O{} m m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    \c_backslash_str symii~is~deprecated! \\
    Please~use~\c_backslash_str symdecl[#1]{#2-#3}~instead!~(in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq)
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}
  \symdecl*[#1]{#2-#3}
}

\cs_new_protected:Npn \symiii {
  \peek_charcode_remove:NTF * {
    \symiii_do:
  } {
    \symiii_do:
  }
}

\NewDocumentCommand \symiii_do: { O{} m m m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    \c_backslash_str symiii~is~deprecated! \\
    Please~use~\c_backslash_str symdecl[#1]{#2-#3-#4}~instead!~(in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq)
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}
  \symdecl*[#1]{#2-#3-#4}
}

\keys_define:nn { stex / deprec / defi } {
  name  .tl_set_x:N = \l_tmpa_str
}

\cs_new_protected:Npn \defi {
  \peek_charcode_remove:NTF * {
    \defi_do:
  } {
    \defi_do:
  }
}

\NewDocumentCommand \defi_do: { O{} m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![#2]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{#2} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ #2 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{#2} ]
  }
}


\cs_new_protected:Npn \Defi {
  \peek_charcode_remove:NTF * {
    \Defi_do:
  } {
    \Defi_do:
  }
}

\NewDocumentCommand \Defi_do: { O{} m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str Defi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![\exp_after:wN \stex_capitalize:n #2]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{\exp_after:wN \stex_capitalize:n #2} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str Defi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ \exp_after:wN \stex_capitalize:n #2 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{\exp_after:wN \stex_capitalize:n #2} ]
  }
}

\cs_new_protected:Npn \adefi {
  \peek_charcode_remove:NTF * {
    \adefi_do:
  } {
    \adefi_do:
  }
}

\NewDocumentCommand \adefi_do: { O{} m m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str adefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#3}![#2]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #3 }![ \comp{#2} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str adefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ #2 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{#2} ]
  }
}

\cs_new_protected:Npn \defis {
  \peek_charcode_remove:NTF * {
    \defis_do:
  } {
    \defis_do:
  }
}

\NewDocumentCommand \defis_do: { O{} m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![#2s]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{#2s} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ #2s ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{#2s} ]
  }
}

\cs_new_protected:Npn \defii {
  \peek_charcode_remove:NTF * {
    \defii_do:
  } {
    \defii_do:
  }
}

\NewDocumentCommand \defii_do: { O{} m m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2-#3}![#2~#3]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2-#3 }![ \comp{#2~#3} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ #2~#3 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{#2~#3} ]
  }
}


\cs_new_protected:Npn \defiis {
  \peek_charcode_remove:NTF * {
    \defiis_do:
  } {
    \defiis_do:
  }
}

\NewDocumentCommand \defiis_do: { O{} m m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defiis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2-#3}![#2~#3s]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2-#3 }![ \comp{#2~#3s} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defiis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ #2~#3s ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{#2~#3s} ]
  }
}


\cs_new_protected:Npn \defiii {
  \peek_charcode_remove:NTF * {
    \defiii_do:
  } {
    \defiii_do:
  }
}

\NewDocumentCommand \defiii_do: { O{} m m m } {
  \str_clear:N \l_tmpa_str
  \keys_set:nn { stex / deprec / defi } { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defiii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2-#3-#4}![#2~#3~#4]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2-#3-#4 }![ \comp{#2~#3~#4} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str defiii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { \l_tmpa_str }[ #2~#3~#4 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \exp_args:No \STEXsymbol { \l_tmpa_str }![ \comp{#2~#3~#4} ]
  }
}

%\RequirePackage[hyperref]{ntheorem}
%\theoremstyle{plain}
%\RequirePackage{amsthm}

\NewDocumentEnvironment {definition} { O{} } {
  \begin{STEXdefinition}{}
}{
  \end{STEXdefinition}
}

\let\titleemph\textbf

\keys_define:nn { stex / omtext} {
  id      .str_set_x:N   = \l_stex_omtext_id_str , 
  title   .tl_set:N   = \l_stex_omtext_title_tl , 
  type    .tl_set_x:N   = \l_stex_omtext_type_tl ,
  for     .tl_set_x:N   = \l_stex_omtext_for_tl ,
  from    .tl_set_x:N   = \l_stex_omtext_from_tl ,
  start   .tl_set:N   = \l_stex_omtext_start_tl ,
}
\cs_new_protected:Nn \stex_omtext_args:n {
  \tl_clear:N \l_stex_omtext_title_tl
  \tl_clear:N \l_stex_omtext_start_tl
  \keys_set:nn { stex / omtext }{ #1 }
}
\NewDocumentEnvironment {omtext} { O{} } {
  \stex_omtext_args:n { #1 }
  \titleemph{\tl_if_empty:NTF \l_stex_omtext_start_tl {
    \l_stex_omtext_title_tl
  }{
    \l_stex_omtext_start_tl :
  }}

  \stex_ref_new_doc_target:n \l_stex_omtext_id_str
}{
  
}
\NewDocumentEnvironment {assertion} { O{} } {
  
}{
  
}

\NewDocumentCommand \inlinedef { m } {
  \begingroup
  \stex_reactivate_macro:N \definiendum
  \stex_reactivate_macro:N \definame
  \stex_ref_new_doc_target:n{}
  #1
  \endgroup
}

\NewDocumentCommand \inlineass { m } { #1 }

\NewDocumentCommand \trefi { O{} m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![#2]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{#2} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1?#2 }[ #2 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{#2} ]
  }
}


\NewDocumentCommand \Trefi { O{} m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str Trefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![\exp_after:wN \stex_capitalize:n #2]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{\exp_after:wN \stex_capitalize:n #2} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str Trefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1 }[ \exp_after:wN \stex_capitalize:n #2 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{\exp_after:wN \stex_capitalize:n #2} ]
  }
}

\NewDocumentCommand \trefis { O{} m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![#2s]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{#2s} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefi~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1 }[ #2s ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{#2s} ]
  }
}


\NewDocumentCommand \Trefis { O{} m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str Trefis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2}![\exp_after:wN \stex_capitalize:n #2s]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2 }![ \comp{\exp_after:wN \stex_capitalize:n #2s} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str Trefis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1 }[ \exp_after:wN \stex_capitalize:n #2s ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{\exp_after:wN \stex_capitalize:n #2s} ]
  }
}

\NewDocumentCommand \trefii { O{} m m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2-#3}![#2~#3]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2-#3 }![ \comp{#2~#3} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1 }[ #2~#3 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{#2~#3} ]
  }
}

\NewDocumentCommand \trefiii { O{} m m m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefiii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2-#3-#4}![#2~#3~#4]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2-#3-#4 }![ \comp{#2~#3~#4} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefiii~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1 }[ #2~#3~#4 ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{#2~#3~#4} ]
  }
}


\NewDocumentCommand \trefiis { O{} m m } {
  \str_set:Nn \l_tmpa_str { #1 }
  \str_if_empty:NTF \l_tmpa_str {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefiis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol{#2-#3}![#2~#3s]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #2-#3 }![ \comp{#2~#3s} ]
  } {
    \msg_set:nnn{stex}{warning/deprecated}{
      \\
      \c_backslash_str trefiis~is~deprecated! \\
      Please~use~\c_backslash_str STEXsymbol { #1 }[ #2~#3s ]~instead!~(in~file~
      \stex_path_to_string:N \g_stex_currentfile_seq)
      \\ \\
    }
    \msg_warning:nn{stex}{warning/deprecated}
    \STEXsymbol { #1 }![ \comp{#2~#3s} ]
  }
}

\NewDocumentCommand \symvariant { O{} m O{0} m m} {
  \msg_set:nnn{stex}{warning/deprecated}{
    \\
    \c_backslash_str symvariant~is~deprecated! \\
    Please~use~\c_backslash_str notation[#4]{ #2 }~instead!~(in~file~
    \stex_path_to_string:N \g_stex_currentfile_seq)
    \\ \\
  }
  \msg_warning:nn{stex}{warning/deprecated}

  \notation[variant=#4]{#2}{#5}
}

\NewDocumentCommand \mixfixi { O{} m m m} {
  \msg_set:nnn{stex}{warning/deprecated}{
    \c_backslash_str mixfixi~is~fatally~deprecated!\\
    Symbol:~\l__stex_term_highlight_uri_str\\
    Current~file:~\stex_path_to_string:N \g_stex_currentfile_seq
  }
  \msg_error:nn{stex}{warning/deprecated}
}


\NewDocumentCommand \infix {} {
  \msg_set:nnn{stex}{warning/deprecated}{
    \c_backslash_str infix~is~fatally~deprecated!\\
    Symbol:~\l__stex_term_highlight_uri_str\\
    Current~file:~\stex_path_to_string:N \g_stex_currentfile_seq
  }
  \msg_error:nn{stex}{warning/deprecated}
}

\let\iprec\infprec

\NewDocumentCommand \inlineex { m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \c_backslash_str inlineex~is~deprecated!\\
    No~replacement~exists~yet.\\
    Current~file:~\stex_path_to_string:N \g_stex_currentfile_seq
  }
  \msg_warning:nn{stex}{warning/deprecated}
  #1
}


\NewDocumentCommand \term { m } {
  \msg_set:nnn{stex}{warning/deprecated}{
    \c_backslash_str term~is~deprecated!\\
    No~replacement~exists~yet.\\
    Current~file:~\stex_path_to_string:N \g_stex_currentfile_seq
  }
  \msg_warning:nn{stex}{warning/deprecated}
  #1
}


\NewDocumentCommand \Definame { O{} m } {
  \stex_get_symbol:n { #2 }
  \str_set:Nx \l_tmpa_str {
    \prop_item:cn { g_stex_symdecl_ \l_stex_get_symbol_uri_str _prop } { name }
  }
  \exp_args:NNno \str_replace_all:Nnn \l_tmpa_str {-} {~}
  \stex_ref_new_sym_target:n \l_stex_get_symbol_uri_str
  \scalatex_if:TF {
    \stex_annotate:nnn { definiendum } { \l_stex_get_symbol_uri_str } { 
      \l_tmpa_str
     }
  } {
    \defemph@uri {
      \exp_after:wN \stex_capitalize:n \l_tmpa_str
    } { \l_stex_get_symbol_uri_str }
  }
}

\NewDocumentCommand \Definiendum { O{} m m } {
  \stex_get_symbol:n { #2 }
  \str_set:Nx \l_tmpa_str {
    \prop_item:cn { g_stex_symdecl_ \l_stex_get_symbol_uri_str _prop } { name }
  }
  \exp_args:NNno \str_replace_all:Nnn \l_tmpa_str {-} {~}
  \stex_ref_new_sym_target:n \l_stex_get_symbol_uri_str
  \scalatex_if:TF {
    \stex_annotate:nnn { definiendum } { \l_stex_get_symbol_uri_str } { 
      \l_tmpa_str
     }
  } {
    \defemph@uri {
      \exp_after:wN \stex_capitalize:n \l_tmpa_str
    } { \l_stex_get_symbol_uri_str }
  }
}

\NewDocumentCommand \Symname { O{} m }{
  \stex_symname_args:n { #1 }
  \stex_get_symbol:n { #2 }
  \str_set:Nx \l_tmpa_str {
    \prop_item:cn { g_stex_symdecl_ \l_stex_get_symbol_uri_str _prop } { name }
  }
  \exp_args:NNno \str_replace_all:Nnn \l_tmpa_str {-} {~}
  \let\compemph_uri_prev:\compemph@uri
  \let\compemph@uri\symrefemph@uri
  \exp_args:NNx \use:nn
  \stex_invoke_symbol:n { { \l_stex_get_symbol_uri_str }![
    \exp_after:wN \stex_capitalize:n \l_tmpa_str
      \l_stex_symname_post_str
  ] }
  \let\compemph@uri\compemph_uri_prev:
}


\seq_gput_right:Nx \g_stex_smsmode_allowedenvs_seq { \tl_to_str:n { mhmodnl } }
\seq_gput_right:Nx \g_stex_smsmode_allowedenvs_seq { \tl_to_str:n { modsig } }
\tl_gput_right:Nn \g_stex_smsmode_allowedmacros_escape_tl {\gimport\symi\symii\symiii\symiv\symvariant}

% omtext:
\cs_new_protected:Npn \lec #1 {
  \strut\hfil\strut\null\hfill(#1)
}
\cs_new_protected:Npn \nlex #1 {
  \textcolor{green}{{\sl #1}}  
}

\cs_new_protected:Npn \nlcex #1 {
  *\;\textcolor{green}{{\sl #1}}  
}

\newcommand\hateq{\ensuremath{\widehat=}\xspace}
\newcommand\hatequiv{\ensuremath{\widehat\equiv}\xspace}
\@ifundefined{ergo}%
{\newcommand\ergo{\ensuremath{\leadsto}\xspace}}%
{\renewcommand\ergo{\ensuremath{\leadsto}\xspace}}%
\newcommand{\reflect@squig}[2]{\reflectbox{$\m@th#1\rightsquigarrow$}}%
\newcommand\ogre{\ensuremath{\mathrel{\mathpalette\reflect@squig\relax}}\xspace}%
\newcommand\notergo{\ensuremath{\not\leadsto}}
\newcommand\notogre{\ensuremath{\not\mathrel{\mathpalette\reflect@squig\relax}}\xspace}%

% mathhub convenience macros

\define@key{Gin}{mhrepos}{\def\Gin@mhrepos{#1}}
\newcommand\mhgraphics[2][]{%
  \def\Gin@mhrepos{}\setkeys{Gin}{#1}%
  \includegraphics[#1]{\mhpath\Gin@mhrepos{#2}}}
\newcommand\cmhgraphics[2][]{\begin{center}\mhgraphics[#1]{#2}\end{center}}

\define@key{lst}{mhrepos}{\def\lst@mhrepos{#1}}
\newcommand\lstinputmhlisting[2][]{%
  \def\lst@mhrepos{}\setkeys{lst}{#1}%
  \lstinputlisting[#1]{\mhpath\lst@mhrepos{#2}}}
\newcommand\clstinputmhlisting[2][]{\begin{center}\lstinputmhlisting[#1]{#2}\end{center}}

%%%%%%%%%%%%% CHEATING --> implement us %%%%%%%%%%%%%%%%%%
\newcommand\assdef[2][]{#2}
\newcommand\impdec[1]{#1}
\newenvironment{inlineAssertion}{}{}
\newenvironment{sproof}[2][]{#2}{}
\newenvironment{subproof}[2][]{#2}{}
\newenvironment{sproofcomment}[2][]{}{}
\newcommand\spidea[2][]{#2}
\newcommand\spfsketch[2][]{#2}
\newenvironment{spfstep}[1][]{}{}
\newenvironment{spfeq}[1][]{\begin{eqnarray*}}{\end{eqnarray*}}
\newenvironment{seqnarray}[1][]{\begin{eqnarray*}}{\end{eqnarray*}}
\newenvironment{spfcases}[2][]{#2}{}
\newenvironment{spfcase}[2][]{#2}{}
\newcommand\gstructure[3][]{\importmodule[#1]{#3}}
\newcommand\fassign[3]{}
\newcommand\vassign[2]{}
\newcommand\tassign[2]{}
\newenvironment{gviewsig}[4][]{}{}
\newenvironment{gviewnl}[5][]{}{}
\newenvironment{mhview}[5][]{}{}
\newenvironment{axiom}[1][]{}{}
\newenvironment{example}[1][]{}{}
\newenvironment{sblockquote}[1][]{}{}
\newcommand\hypernym[3][1]{}
\newcommand\withcite[2]{}
\newcommand\sref[2][]{}
\newcommand\srefs[3][]{}
